nput {
  file {
    path => "/usr/share/logstash/logs/syslog"  # Path to your syslog file
    start_position => "beginning"
    sincedb_path => "/dev/null"  # Disable sincedb to read from the start every time (for testing)
    codec => "plain"  # Use plain codec for syslog
  }
}

filter {
  # Grok filter to parse syslog format
  grok {
    match => { "message" => "%{SYSLOGTIMESTAMP:timestamp} %{SYSLOGHOST:host} %{DATA:program}\[%{NUMBER:pid}\]: %{GREEDYDATA:log_message}" }
  }

  # Date filter to convert the timestamp into a Logstash date format
  date {
    match => [ "timestamp", "MMM dd HH:mm:ss", "MMM dd HH:mm:ss.000" ]
    target => "@timestamp"
  }

  # Optionally, you can add additional filters based on your needs
  # For example, extracting more fields or adding conditions.
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]  # Adjust according to your Elasticsearch setup
    index => "syslog-%{+YYYY.MM.dd}"
  }

  # For debugging purposes, you can also output to stdout
  #stdout { 
   # codec => rubydebug 
  #}
}


